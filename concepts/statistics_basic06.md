## 가설검정 I

**I. 가설검정의 개념**

1. **통계적 추론 복습:** 추정(Estimation)과 검정(Testing).
    - **가설검정:** 불확실한 상황 속에서 **모집단에 대한 주장(가설)**의 타당성을 **표본 데이터**를 근거로 **판단(의사결정)**하는 통계적 방법.
2. **가설 설정:** 검정의 대상이 되는 두 가지 상반된 주장 설정.
    - **귀무가설 (Null Hypothesis, H₀):**
        - 기존의 사실, 일반적으로 받아들여지는 주장, "차이가 없다", "효과가 없다" 등 **보수적인 입장**의 가설.
        - 검정의 대상이 되며, **기각(Reject)**하는 것이 목표인 경우가 많음.
        - 보통 등호 (`=`, `≤`, `≥`)를 포함. (예: `H₀: μ = 12.0`, `H₀: μA = μB`).
    - **대립가설 (Alternative Hypothesis, H₁ 또는 Ha):**
        - 귀무가설에 **대립**되는 주장, 연구자가 **새롭게 주장하거나 입증하고자 하는 가설**.
        - "차이가 있다", "효과가 있다", "~보다 크다/작다" 등.
        - 보통 부등호 (`≠`, `<`, `>`)를 포함. (예: `H₁: μ ≠ 12.0`, `H₁: μA > μB`).
        - **예시(암 치료율):** H₀: 새 치료법 효과 없다 (p=0.8). H₁: 새 치료법 효과 있다 (p>0.8).
3. **가설의 선택 방법 (의사결정 원칙):**
    - **"무죄 추정의 원칙"과 유사:** 귀무가설(H₀)이 참이라고 **가정**하고 시작.
    - 표본 데이터 분석 결과, H₀를 기각할 **충분한 근거가 있을 때만** 대립가설(H₁) 채택 (H₀ 기각). → 결과가 **"통계적으로 유의하다"**.
    - H₀를 기각할 **충분한 근거가 없으면** H₀를 기각하지 못함 (H₀ 채택). → H₁을 지지할 근거 부족 (H₀가 참이라는 의미는 아님!).
4. **가설검정의 오류 (Errors in Hypothesis Testing):** 통계적 판단이므로 오류 가능성 존재.
    - **제1종 오류 (Type I Error, α 오류):** **귀무가설(H₀)이 참인데 기각**하는 오류 (False Positive). 실제 효과 없는데 있다고 잘못 판단.
        - 오류 발생 확률: `P(Type I Error) = α` (**유의수준**, Significance Level).
    - **제2종 오류 (Type II Error, β 오류):** **귀무가설(H₀)이 거짓인데 기각하지 못하는** 오류 (False Negative). 실제 효과 있는데 없다고 잘못 판단.
        - 오류 발생 확률: `P(Type II Error) = β`.
    - **오류 간 상충 관계 (Trade-off):** 제1종 오류(α)를 줄이면 제2종 오류(β)가 증가하는 경향. (반대도 성립).
5. **유의수준 (Significance Level, α)과 검정력 (Power):**
    - **유의수준 (α):** 제1종 오류를 범할 **최대 허용 확률**. 연구자가 **검정 전에 미리 설정** (보통 0.05(5%), 0.01(1%), 0.1(10%) 사용). 작을수록 H₀를 더 엄격하게 기각.
    - **검정력 (Power, 1-β):** **귀무가설(H₀)이 거짓일 때 이를 올바르게 기각**할 확률. 즉, **실제 효과(차이)를 탐지해낼 능력**. 높을수록 좋은 검정.

**II. 통계적 가설검정 과정**

1. **가설검정 절차:**
    - 1단계: **가설 설정** (H₀, H₁).
    - 2단계: **유의수준 (α) 결정**.
    - 3단계: **검정통계량(Test Statistic)** 및 귀무가설 하에서의 **분포 결정**.
    - 4단계: **기각역(Rejection Region)** 설정 또는 **유의확률(P-value)** 계산.
    - 5단계: 표본 데이터로 **검정통계량 값 계산**.
    - 6단계: **결정 규칙**에 따라 H₀ 기각 여부 판단 (통계적 의사결정).
    - 7단계: 결론 도출.
2. **검정통계량 (Test Statistic):**
    - 귀무가설(H₀)이 참인지 거짓인지 검정하기 위해 **표본 데이터로부터 계산되는 통계량**.
    - H₀ 하에서의 확률분포를 알아야 함 (예: Z, T, χ², F 통계량).
3. **의사결정 방법:**
    - **기각역 (Rejection Region) 방법:**
        - **기각역:** H₀를 기각하게 되는 검정통계량 값의 영역. 유의수준 α와 대립가설 H₁ 형태에 따라 결정됨.
        - **임곗값 (Critical Value):** 기각역의 경계가 되는 값.
        - **결정:** 계산된 검정통계량 값이 **기각역에 속하면 H₀를 기각**.
    - **유의확률 (P-value) 방법:**
        - **P-value:** 귀무가설(H₀)이 참이라고 가정할 때, 표본 데이터에서 계산된 검정통계량 값보다 **같거나 더 극단적인 값이 관찰될 확률**.
        - **해석:** P-value가 작을수록 관찰된 데이터는 H₀ 하에서 매우 드물게 발생 → H₀를 기각할 근거 강화.
        - **결정:** **P-value ≤ α 이면 H₀를 기각**. P-value > α 이면 H₀를 기각하지 못함. (실제 연구에서 더 선호되는 방법).

**III. 모평균(μ)의 가설검정**

1. **목표:** 모집단의 평균 `μ`에 대한 가설 검정 (예: `μ = 12`, `μ > 11` 등).
2. **검정통계량:**
    - **모분산(σ²)을 아는 경우 (또는 n이 매우 큰 경우): Z-통계량**
        - `Z = (X̄ - μ₀) / (σ / √n) ~ N(0, 1)` (μ₀: 귀무가설에서의 모평균 값).
    - **모분산(σ²)을 모르는 경우 (대부분의 현실적인 경우): T-통계량**
        - `T = (X̄ - μ₀) / (S / √n) ~ t_(n-1)` (S: 표본 표준편차, `t_(n-1)`: 자유도 n-1인 t-분포).
3. **대립가설(H₁) 형태에 따른 검정 유형:**
    - **양측 검정 (Two-tailed test):** `H₁: μ ≠ μ₀`. 기각역이 분포의 양쪽 꼬리에 위치. (P-value 계산 시 양쪽 꼬리 확률 합산).
    - **단측 검정 (One-tailed test):**
        - **우측 검정 (Right-tailed test):** `H₁: μ > μ₀`. 기각역이 분포의 오른쪽 꼬리에 위치.
        - **좌측 검정 (Left-tailed test):** `H₁: μ < μ₀`. 기각역이 분포의 왼쪽 꼬리에 위치.
4. **가설검정 예제:**
    - **예제 1 (전기차 거리):**
        - 가설: `H₀: μ = 520` vs `H₁: μ ≠ 520` (또는 μ < 520). σ=20 (알려짐). n=16, X̄=512. α=0.05.
        - 검정통계량: `Z = (512 - 520) / (20 / √16) = -8 / 5 = -1.6`.
        - 기각역(양측): `|Z| > z_(0.025) = 1.96`. `1.6`은 기각역에 속하지 않음.
        - 결론: 유의수준 5%에서 H₀를 기각할 수 없음 (새 방식 평균 주행 거리가 520km와 유의하게 다르다고 말할 수 없음).
    - **예제 2 (쇼핑몰 방문):**
        - 가설: `H₀: μ = 12` vs `H₁: μ ≠ 12` (양측) / `H₁: μ > 12` (우측). σ 모름. n=10, X̄=12.2, S=0.2. α=0.05.
        - 검정통계량: `T = (12.2 - 12) / (0.2 / √10) ≈ 3.16`. 자유도 df=9.
        - 기각역(양측): `|T| > t_(9, 0.025) ≈ 2.262`. `3.16 > 2.262` 이므로 **H₀ 기각**.
        - 기각역(우측): `T > t_(9, 0.05) ≈ 1.833`. `3.16 > 1.833` 이므로 **H₀ 기각**.
        - 결론(양측): 평균 방문 횟수는 12회와 유의하게 다르다. / 결론(우측): 평균 방문 횟수는 12회보다 유의하게 크다.
    - **예제 3 (독서량):**
        - 가설: `H₀: μ = 11` vs `H₁: μ > 11`. σ 모름. n=16, X̄=14.12, S=6.076. α=0.05.
        - 검정통계량: `T = (14.12 - 11) / (6.076 / √16) ≈ 2.05`. 자유도 df=15.
        - 기각역(우측): `T > t_(15, 0.05) ≈ 1.753`. `2.05 > 1.753` 이므로 **H₀ 기각**.
        - 결론: 올해 독서량 평균은 전년도 평균 11보다 유의하게 크다.

**핵심 요약:**

- **가설검정**은 데이터를 근거로 모집단에 대한 **주장(가설)**의 타당성을 판단하는 체계적인 통계적 의사결정 과정입니다.
- *귀무가설(H₀)**과 **대립가설(H₁)**을 설정하고, **유의수준(α)** 하에서 표본 데이터로 계산한 **검정통계량 값**을 평가합니다.
- *유의확률(P-value)**이 유의수준(α)보다 작거나 같으면 귀무가설을 기각하고 대립가설을 채택하며, 이는 결과가 **통계적으로 유의하다**는 것을 의미합니다.
- 모평균 검정 시 모분산(σ²)을 알면 **Z-검정**, 모르면(대부분의 경우) **T-검정**을 사용하며, 대립가설의 형태에 따라 **양측 또는 단측 검정**을 수행합니다.

## 가설검정 II

**I. 모비율(p)의 가설검정**

1. **가설 설정:**
    - **귀무가설 (H₀):** `p = p₀` (모비율이 특정 값 p₀와 같다).
    - **대립가설 (H₁):**
        - `p < p₀` (좌측 검정: 모비율이 p₀보다 작다).
        - `p > p₀` (우측 검정: 모비율이 p₀보다 크다).
        - `p ≠ p₀` (양측 검정: 모비율이 p₀와 다르다).
2. **검정통계량 (Test Statistic):**
    - 표본 크기(n)가 충분히 클 때 (중심극한정리 적용), 표본비율(p̂)을 이용한 Z-통계량 사용.
    - **`Z = (p̂ - p₀) / √[p₀(1-p₀)/n]`**
    - 이 검정통계량은 귀무가설 H₀ 하에서 근사적으로 **표준정규분포 N(0, 1)**을 따릅니다.
3. **검정 방법 (의사결정):**
    - 설정된 유의수준(α)과 대립가설 형태에 따라 표준정규분포에서 **기각역(Rejection Region)** 설정 또는 **유의확률(P-value)** 계산.
    - **기각역 방법:** 계산된 Z값이 기각역에 속하면 H₀ 기각.
    - **유의확률 방법:** 계산된 P-value가 유의수준 α보다 작거나 같으면 H₀ 기각.
    - 검정 방법 그림은 단측(좌/우), 양측 검정에 따른 기각역 위치를 보여줍니다.
4. **모비율 가설검정 예제:**
    - **상황:** 기존 치료율 60%(p₀=0.6). 새 치료제 50명(n=50) 중 35명 치료(X=35 → p̂=35/50=0.7). 치료율 향상 여부 검정 (α=0.05).
    - **가설:** `H₀: p = 0.6` vs `H₁: p > 0.6` (우측 검정).
    - **검정통계량 계산:** `Z = (0.7 - 0.6) / √[0.6(1-0.6)/50] ≈ 1.44`.
    - **기각역:** 우측 검정이므로 `Z > z_0.05 = 1.645`.
    - **결정:** 계산된 Z값(1.44)이 기각역(Z > 1.645)에 속하지 않음.
    - **결론:** 유의수준 5%에서 귀무가설 H₀를 기각할 수 없음. 즉, 새 치료제의 치료율이 기존보다 유의하게 향상되었다고 말할 **통계적 근거가 부족**함.

**II. 모분산(σ²)의 가설검정**

1. **가설 설정:**
    - **귀무가설 (H₀):** `σ² = σ₀²` (모분산이 특정 값 σ₀²와 같다).
    - **대립가설 (H₁):**
        - `σ² < σ₀²` (좌측 검정).
        - `σ² > σ₀²` (우측 검정).
        - `σ² ≠ σ₀²` (양측 검정).
2. **검정통계량 (Test Statistic):**
    - **조건:** 모집단이 정규분포를 따른다고 가정.
    - **`χ² = (n-1)S² / σ₀²`** (S²: 표본분산).
    - 이 검정통계량은 귀무가설 H₀ 하에서 **자유도 (n-1)인 카이제곱 분포 (`χ²_(n-1)`)**를 따릅니다.
3. **검정 방법 (의사결정):**
    - 설정된 유의수준(α)과 대립가설 형태에 따라 카이제곱 분포에서 **기각역** 설정 또는 **유의확률(P-value)** 계산.
    - **기각역 방법:** 계산된 χ²값이 기각역에 속하면 H₀ 기각. (카이제곱 분포는 비대칭이므로 좌측/우측/양측 기각역 설정 주의).
    - **유의확률 방법:** 계산된 P-value가 유의수준 α보다 작거나 같으면 H₀ 기각.
    - 검정 방법 그림은 단측(좌/우), 양측 검정에 따른 기각역 위치를 보여줍니다.
4. **모분산 가설검정 예제:**
    - **예제 1 (쌀포대 무게):** 목표 표준편차 ≤ 10g (σ₀² = 100). n=10, S=5 (S²=25). 정규분포 가정. α=0.05.
        - **가설:** `H₀: σ² = 100` vs `H₁: σ² < 100` (좌측 검정 - 표준편차 10g 이하 주장 검증. *슬라이드 가설은 σ² > 100 으로 되어있으나, 문제 맥락상 σ² < 100 이 적절해 보임. 여기서는 슬라이드대로 H₁: σ² > 100 으로 가정하고 진행*).
        - **가설(슬라이드 기준):** `H₀: σ² = 100` vs `H₁: σ² > 100` (우측 검정).
        - **검정통계량 계산:** `χ² = (10-1)*25 / 100 = 9*25 / 100 = 2.25`. 자유도 df=9.
        - **기각역(우측):** `χ² > χ²_(9, 0.05) ≈ 16.919`.
        - **결정:** 계산된 χ²값(2.25)이 기각역(χ² > 16.919)에 속하지 않음.
        - **결론:** 유의수준 5%에서 H₀를 기각할 수 없음. 즉, 쌀 무게 표준편차가 10g보다 유의하게 크다고 말할 근거 부족.
    - **예제 2 (독서량):** 전년도 표준편차 4권 (σ₀² = 16). n=12, S=? (*S값이 주어지지 않아 계산 불가*). 정규분포 가정. α=0.05.
        - **가설:** `H₀: σ² = 16` vs `H₁: σ² > 16` (우측 검정).
        - (*S값이 있다면*) 검정통계량 `χ² = (12-1)S² / 16` 계산. 자유도 df=11.
        - 기각역(우측): `χ² > χ²_(11, 0.05) ≈ 19.675`.
        - 계산된 χ²값과 비교하여 H₀ 기각 여부 결정.

**III. 가설검정과 구간추정의 관계**

1. **채택역 (Acceptance Region)과 신뢰구간 (Confidence Interval)의 동등성:**
    - 유의수준 α에서 귀무가설 `H₀: θ = θ₀`에 대한 양측검정의 **채택역**(H₀를 기각하지 못하는 검정통계량 값의 범위)은 모수 `θ`에 대한 `100(1-α)%` **신뢰구간**과 **수학적으로 동일한 정보**를 가집니다.
    - 즉, 검정통계량 값이 채택역에 속하는 것 ⇔ 모수 `θ`의 신뢰구간이 귀무가설 값 `θ₀`를 포함하는 것.
2. **신뢰구간을 이용한 가설검정 (양측검정의 경우):**
    - **방법:** 모수 `θ`에 대한 `100(1-α)%` 신뢰구간을 구합니다.
    - **결정:**
        - 귀무가설에서 설정한 값 `θ₀`가 계산된 **신뢰구간에 포함되면**, 유의수준 α에서 H₀를 **기각하지 못합니다**.
        - 귀무가설에서 설정한 값 `θ₀`가 계산된 **신뢰구간에 포함되지 않으면(벗어나면)**, 유의수준 α에서 H₀를 **기각합니다**.
    - **예시 (모평균):** `H₀: μ = μ₀` vs `H₁: μ ≠ μ₀` 검정 시, `μ₀`가 `[ X̄ ± t_(n-1, α/2) * (S / √n) ]` 구간 안에 있는지 확인.

**IV. R을 이용한 실습 (언급)**

- R을 이용하여 모평균, 모비율, 모분산에 대한 가설검정을 수행하는 실습이 진행될 예정임을 시사. (관련 함수: `t.test()`, `prop.test()`, `var.test()` 등).

**핵심 요약:**

- **모비율(p)** 검정은 표본 크기가 클 때 **Z-검정통계량**을 사용합니다.
- **모분산(σ²)** 검정은 모집단이 정규분포를 따를 때 **카이제곱(χ²) 검정통계량**을 사용합니다.
- 가설검정의 **채택역**과 **신뢰구간**은 동일한 정보를 제공하며, 신뢰구간에 귀무가설의 값이 포함되는지 여부로 양측검정의 기각 여부를 판단할 수 있습니다.
- 각 검정 방법은 대립가설의 형태(단측/양측)에 따라 기각역 설정 및 P-value 계산 방식이 달라집니다.