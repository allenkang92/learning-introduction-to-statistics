## 회귀모형 I

**I. 상관계수 (Correlation Coefficient)**

1. **상관 분석의 목적:** 두 **연속형 변수** 사이의 **선형적인 관계의 강도와 방향**을 파악.
2. **시각화 도구: 산점도 (Scatter Plot)**
    - **개념:** 두 변수의 값을 각각 X축과 Y축으로 하여 각 관측값을 점으로 나타낸 그래프.
    - **용도:** 두 변수 간 관계의 형태(선형/비선형), 방향(양/음), 강도(밀집/분산)를 시각적으로 파악.
3. **상관계수 (Correlation Coefficient): `r`**
    - **개념:** 두 연속형 변수 간 **선형 관계의 강도와 방향**을 나타내는 **1에서 +1 사이**의 값.
    - **계산 (표본 상관계수):**
        - 표본 공분산(C<0xE1><0xB5><0x84><0xE1><0xB5><0x92>)을 각 변수의 표본 표준편차(S<0xE1><0xB5><0x84>, S<0xE1><0xB5><0x92>)의 곱으로 나누어 표준화.
        - `r = C<0xE1><0xB5><0x84><0xE1><0xB5><0x92> / (S<0xE1><0xB5><0x84> * S<0xE1><0xB5><0x92>) = [ Σ(xᵢ - x̄)(yᵢ - ȳ) / (n-1) ] / [ √(Σ(xᵢ - x̄)²/(n-1)) * √(Σ(yᵢ - ȳ)²/(n-1)) ]`
    - **특징 및 해석:**
        - `+1`에 가까울수록 **강한 양의 선형 관계**.
        - `1`에 가까울수록 **강한 음의 선형 관계**.
        - `0`에 가까울수록 **선형 관계가 약함**.
        - 값이 정확히 +1 또는 -1이면 모든 점이 한 직선 위에 있음.
        - **주의:** 상관계수는 **선형 관계만** 측정. 값이 0에 가까워도 비선형 관계는 존재할 수 있음. **상관관계가 인과관계를 의미하지는 않음**.

**II. 단순 선형 회귀 모형 (Simple Linear Regression Model)**

1. **회귀 분석 (Regression Analysis)이란?**
    - **목적:** 변수들 간의 **함수적 관계**를 통계적 모형을 이용하여 규명하고, 한 변수(독립변수)를 이용하여 다른 변수(종속변수)를 **설명하고 예측**하는 분석 방법.
    - **주요 개념:**
        - **회귀식 (Regression Equation):** 변수 간 관계를 나타내는 수학적 모형(함수).
        - **종속변수 (Dependent Variable, Y):** 설명되거나 예측하고자 하는 변수 (반응 변수).
        - **독립변수 (Independent Variable, X):** 종속변수에 영향을 주는 변수 (설명 변수).
2. **단순 선형 회귀 모형:**
    - **개념:** **하나의 독립변수(X)**를 이용하여 **종속변수(Y)**를 **선형(직선)** 관계로 설명하는 모형.
    - **모형식:** `Yᵢ = α + βXᵢ + εᵢ`
        - `Yᵢ`: i번째 관측값의 종속변수 값.
        - `Xᵢ`: i번째 관측값의 독립변수 값.
        - `α`: **절편 (Intercept)**. X=0일 때의 Y의 평균값. (모수).
        - `β`: **기울기 (Slope)**. X가 1단위 증가할 때 Y의 평균적인 변화량. (모수).
        - `εᵢ`: **오차항 (Error Term)**. 회귀식으로 설명되지 않는 부분. 서로 독립이고 평균 0, 분산 σ²인 정규분포 가정.
    - **추정된 회귀식:** `ŷᵢ = a + bXᵢ`
        - `ŷᵢ`: Xᵢ에 대한 Y의 예측값.
        - `a`: 추정된 절편.
        - `b`: 추정된 기울기.
3. **회귀 계수 추정: 최소제곱법 (Method of Least Squares, OLS):**
    - **목적:** 실제 관측값(Yᵢ)과 회귀식에 의한 예측값(ŷᵢ)의 차이, 즉 **잔차(Residual, eᵢ = Yᵢ - ŷᵢ)**의 **제곱합(Sum of Squared Errors, SSE = Σeᵢ²)**을 **최소화**하는 회귀 계수(a, b)를 찾는 방법. (a, b에 대해 편미분하여 해를 구함).
    - **추정 공식:**
        - 기울기 `b = C<0xE1><0xB5><0x84><0xE1><0xB5><0x92> / S<0xE1><0xB5><0x84>² = r * (S<0xE1><0xB5><0x92> / S<0xE1><0xB5><0x84>)`
        - 절편 `a = ȳ - b * x̄`
    - **기울기(b)와 상관계수(r)의 관계:** 부호는 항상 같음. `b = r * (Sy / Sx)`.
4. **회귀직선의 적합도 평가:**
    - **변동 분해:** 총 변동(SST) = 회귀식에 의해 설명된 변동(SSR) + 설명되지 않은 변동(SSE).
        - `SST (Total Sum of Squares) = Σ(Yᵢ - ȳ)²`
        - `SSR (Regression Sum of Squares) = Σ(ŷᵢ - ȳ)²`
        - `SSE (Error Sum of Squares) = Σ(Yᵢ - ŷᵢ)² = Σeᵢ²`
    - **결정계수 (Coefficient of Determination, R²):**
        - **개념:** 총 변동(SST) 중 회귀식에 의해 **설명되는 변동(SSR)의 비율**. 회귀직선이 데이터를 얼마나 잘 설명하는지(적합도) 나타내는 척도.
        - **계산:** `R² = SSR / SST = 1 - (SSE / SST)`.
        - **범위:** 0 ≤ R² ≤ 1.
        - **해석:** R² 값이 1에 가까울수록 회귀직선의 설명력이 높고 데이터가 직선 주위에 밀집되어 있음을 의미.
        - **단순 선형 회귀에서는 R² = r²** (상관계수의 제곱).
    - **잔차 표준 오차 (Residual Standard Error, S<0xE2><0x82><0x91>):**
        - 오차항(ε)의 표준편차(σ)에 대한 추정값. 잔차들의 평균적인 크기.
        - `S<0xE2><0x82><0x91> = √(SSE / (n-2)) = √MSE`.
        - 값이 작을수록 회귀직선의 적합도가 높음.

**III. 단순 선형 회귀 모형의 분석 및 추론**

1. **회귀 모형의 유의성 검정 (분산분석표 활용):**
    - **목적:** 추정된 회귀직선이 통계적으로 유의미한지(즉, 기울기 β가 0인지 아닌지) 검정.
    - **가설:** `H₀: β = 0` (X는 Y를 설명하는 데 유의미하지 않다) vs. `H₁: β ≠ 0`.
    - **분산분석표 (ANOVA Table):** SST, SSR, SSE를 각각의 자유도(dfT=n-1, dfR=1, dfE=n-2)로 나누어 평균제곱(MST, MSR, MSE) 계산.
    - **F-통계량:** `F = MSR / MSE`.
    - **검정:** 계산된 F값과 `F(1, n-2; α)` 임곗값 비교. F값이 크거나 P-value가 작으면 H₀ 기각 → 회귀 모형 유의미.
2. **회귀 계수(β, α)에 대한 추론:** (오차항 정규분포 가정 필요)
    - **기울기 β에 대한 추론:**
        - **추정량 b의 분포:** `b ~ N(β, σ² / Σ(xᵢ - x̄)²)`.
        - **표준 오차:** `se(b) = S<0xE2><0x82><0x91> / √Σ(xᵢ - x̄)²`.
        - **t-통계량:** `t = (b - β) / se(b) ~ t_(n-2)`.
        - **β의 신뢰구간:** `[ b ± t_(n-2, α/2) * se(b) ]`.
        - **β에 대한 검정:** `H₀: β = β₀` (주로 β₀=0) vs. H₁. t-통계량 계산 후 t-분포 이용 검정. (ANOVA의 F-검정과 동일한 결과).
    - **절편 α에 대한 추론:**
        - **추정량 a의 분포:** `a = ȳ - b * x̄`. 정규분포 따름.
        - **표준 오차:** `se(a)` 계산 가능 (공식 복잡).
        - **t-통계량:** `t = (a - α) / se(a) ~ t_(n-2)`.
        - **α의 신뢰구간:** `[ a ± t_(n-2, α/2) * se(a) ]`.
        - **α에 대한 검정:** `H₀: α = α₀` (주로 α₀=0) vs. H₁. t-통계량 계산 후 t-분포 이용 검정.
3. **평균 반응(μ<0xE1><0xB5><0x92>|ₓ) 및 개별 예측(Y_new)에 대한 추론:**
    - **평균 반응 신뢰구간:** 특정 `X=x₀` 값에서 **Y의 평균값(μ<0xE1><0xB5><0x92>|ₓ = α + βx₀)**에 대한 신뢰구간.
        - 점추정량: `ŷ₀ = a + bx₀`.
        - 신뢰구간: `[ ŷ₀ ± t_(n-2, α/2) * se(ŷ₀) ]`.
        - **특징:** 신뢰대는 `x₀ = x̄`일 때 가장 좁고, `x̄`에서 멀어질수록 넓어짐.
    - **개별 예측 구간 (Prediction Interval):** 특정 `X=x₀` 값에서 **새로운 Y 관측값(Y_new)**에 대한 예측 구간.
        - 평균 반응 신뢰구간보다 폭이 더 넓음 (개별 값의 불확실성 추가 반영).

**IV. R을 이용한 실습**

- **선형 모형 적합:** `lm()` 함수 사용 (`lm(y ~ x, data = 데이터프레임)`).
- **결과 요약:** `summary()` 함수 사용.
    - **출력 내용:**
        - `Call`: 사용된 함수 호출.
        - `Residuals`: 잔차의 요약 통계량 (Min, 1Q, Median, 3Q, Max).
        - `Coefficients`: 회귀 계수 추정치(Estimate), 표준 오차(Std. Error), t 값(t value), P-value(Pr(>|t|)). (절편(Intercept)과 기울기(x)). `**` 등은 유의수준 표시.
        - `Residual standard error`: 잔차 표준 오차(S<0xE2><0x82><0x91>)와 자유도(n-2).
        - `Multiple R-squared`: 결정계수(R²).
        - `Adjusted R-squared`: 수정된 결정계수 (독립변수 개수 보정).
        - `F-statistic`: 회귀 모형 유의성 검정 F 통계량 값, 자유도(1, n-2), P-value.

**핵심 요약:**

- **상관 분석**은 두 변수 간 **선형 관계**의 강도와 방향을 **상관계수(r)**로 측정하며, **산점도**로 시각화합니다.
- **단순 선형 회귀 분석**은 하나의 **독립변수(X)**로 **종속변수(Y)**를 예측하는 **직선 모형 (`Y = α + βX + ε`)**을 추정합니다.
- *최소제곱법(OLS)**은 잔차 제곱합을 최소화하는 **회귀 계수(a, b)**를 추정합니다.
- 회귀 모형의 적합도는 **결정계수(R²)**와 **잔차 표준 오차** 등으로 평가합니다.
- **분산분석(F-검정)** 또는 **t-검정**을 통해 회귀 모형 또는 회귀 계수의 **통계적 유의성**을 검정할 수 있습니다.
- 추정된 회귀식을 이용하여 특정 X값에 대한 **Y의 평균 반응(신뢰구간)** 또는 **개별 Y값(예측구간)**을 추론할 수 있습니다.
- R의 `lm()` 함수와 `summary()` 함수를 이용하여 단순 선형 회귀 분석을 쉽게 수행하고 결과를 해석할 수 있습니다.

## 회귀모형 II

**I. 중선형 회귀 모형의 적합**

1. **중선형 회귀 모형의 정의:**
    - **개념:** **두 개 이상의 독립변수(X₁, X₂, ..., X<0xE1><0xB5><0x8D>)**를 이용하여 **하나의 종속변수(Y)**를 설명하는 선형 모형.
    - **모형식:** `Yᵢ = β₀ + β₁Xᵢ₁ + β₂Xᵢ₂ + ... + β<0xE1><0xB5><0x8D>X<0xE1><0xB5><0x8D><0xE1><0xB5><0x8D> + εᵢ`
        - `β₀`: 절편 (모든 X가 0일 때 Y의 평균).
        - `β<0xE2><0x82><0x96>` (j=1, ..., p): **편회귀 계수(Partial Regression Coefficient)**. 다른 모든 독립변수들이 **고정**되어 있다는 조건 하에서, `X<0xE2><0x82><0x96>`가 1단위 증가할 때 Y의 평균적인 변화량.
        - `εᵢ`: 오차항. 서로 독립이고 평균 0, 분산 σ²인 정규분포 가정.
    - **행렬 표현:** `Y = Xβ + ε` (Y: 종속변수 벡터, X: 설계 행렬(절편항 포함), β: 회귀계수 벡터, ε: 오차 벡터).
2. **회귀 계수 추정: 최소제곱법 (OLS):**
    - 단순 선형 회귀와 마찬가지로 **잔차 제곱합(SSE = Σ(Yᵢ - ŷᵢ)²)**을 최소화하는 회귀 계수 벡터 `β̂ = (b₀, b₁, ..., b<0xE1><0xB5><0x8D>)`를 찾음.
    - **정규 방정식 (Normal Equations):** 잔차 제곱합을 각 계수로 편미분하여 0으로 놓고 연립 방정식을 풀어서 해를 구함.
    - **행렬 해:** `β̂ = (XᵀX)⁻¹XᵀY`.
3. **오차 분산(σ²) 추정:**
    - `s² = SSE / (n - p - 1) = MSE`. (n: 표본 크기, p: 독립변수 개수).
    - `n - p - 1`: 잔차의 자유도.

**II. 중선형 회귀 모형의 분석 및 추론**

1. **회귀 모형의 적합도:**
    - **추정의 표준 오차 (Residual Standard Error, S<0xE2><0x82><0x91>):** `s = √MSE`. 잔차의 평균적인 크기. 작을수록 적합도 높음.
    - **결정계수 (R²):** `R² = SSR / SST = 1 - (SSE / SST)`. 총 변동 중 회귀 모형에 의해 설명되는 변동의 비율. (0~1 사이 값). 1에 가까울수록 설명력 높음.
    - **수정된 결정계수 (Adjusted R²):** `R²_adj = 1 - [(n-1)/(n-p-1)] * (1 - R²)`. 독립변수 개수가 증가하면 R²가 커지는 경향을 보정. 모형 간 비교 시 사용.
2. **회귀 모형의 유의성 검정 (분산분석표 활용):**
    - **목적:** 적합된 회귀 모형 전체가 통계적으로 유의미한지 검정. (즉, 모든 기울기 β₁, ..., β<0xE1><0xB5><0x8D>가 동시에 0인지 아닌지).
    - **가설:** `H₀: β₁ = β₂ = ... = β<0xE1><0xB5><0x8D> = 0` vs. `H₁: 모든 β<0xE2><0x82><0x96>가 0은 아니다`.
    - **분산분석표 (ANOVA Table):** SST, SSR, SSE 계산 및 자유도(dfT=n-1, dfR=p, dfE=n-p-1)로 나누어 MSR, MSE 계산.
    - **F-통계량:** `F = MSR / MSE`.
    - **검정:** 계산된 F값과 `F(p, n-p-1; α)` 임곗값 비교. P-value가 α보다 작으면 H₀ 기각 → 모형 유의미.
3. **개별 회귀 계수(β<0xE2><0x82><0x96>)에 대한 추론:**
    - **목적:** 각 독립변수가 종속변수에 유의미한 영향을 미치는지 검정.
    - **추정량 b<0xE2><0x82><0x96>의 분포:** 정규분포 따름.
    - **t-통계량:** `t = (b<0xE2><0x82><0x96> - β<0xE2><0x82><0x96>) / se(b<0xE2><0x82><0x96>) ~ t_(n-p-1)`. (se(b<0xE2><0x82><0x96>)는 b<0xE2><0x82><0x96>의 표준 오차).
    - **β<0xE2><0x82><0x96>의 신뢰구간:** `[ b<0xE2><0x82><0x96> ± t_(n-p-1, α/2) * se(b<0xE2><0x82><0x96>) ]`.
    - **β<0xE2><0x82><0x96>에 대한 검정:** `H₀: β<0xE2><0x82><0x96> = 0` vs. H₁. t-통계량 계산 후 t-분포 이용 검정. (R의 `summary(lm_model)` 결과표에서 각 계수별 t값과 P-value 확인 가능).

**III. 회귀 진단 (Regression Diagnostics)**

1. **의의:** 적합된 회귀 모형이 통계적 가정을 잘 만족하는지, 특정 관측치가 모형에 과도한 영향을 미치지는 않는지 등을 검토하여 **모형의 안정성과 타당성**을 평가하는 과정.
2. **잔차 분석 (Residual Analysis):**
    - **목적:** 오차항(ε)에 대한 가정(정규성, 등분산성, 독립성)이 타당한지 **잔차(eᵢ = Yᵢ - ŷᵢ)**를 이용하여 검토.
    - **방법:**
        - **선형성/독립성/등분산성:** **잔차 산점도**(예측값 vs. 잔차) 확인. 특정 패턴 없이 무작위로 흩어져 있어야 함. (부채꼴 모양: 등분산성 위배 / 곡선 패턴: 선형성 위배).
        - **정규성:** 잔차의 **히스토그램** 또는 **정규 확률도(Q-Q Plot)** 확인. 정규 확률도가 직선에 가까우면 정규성 만족.
3. **이상점(Outlier) 및 영향점(Influential Point) 검토:**
    - **이상점:** 다른 관측치들에 비해 **Y값**이 비정상적으로 크거나 작은 관측치. (잔차가 큼).
    - **영향점 (레버리지 포인트):** **X값**이 다른 관측치들과 동떨어져 있어 회귀식 추정에 큰 영향을 미치는 관측치.
    - **탐지:** 표준화 잔차, 스튜던트화 잔차, Cook's Distance, DFFITS, DFBETAS 등 지표 활용.
    - **처리:** 데이터 오류 확인, 제거 또는 변수 변환 고려.
4. **독립변수 간 상관성 검토 (다중공선성 - Multicollinearity):**
    - **개념:** **독립변수들 간에 높은 선형 관계**가 존재하는 문제.
    - **문제점:** 회귀 계수 추정치가 불안정해지고(분산 커짐), 해석이 어려워짐. 개별 계수의 유의성 검정 결과 왜곡 가능성.
    - **탐지:**
        - 독립변수 간 **상관계수 행렬** 확인 (높은 상관계수).
        - **분산 팽창 인수 (VIF - Variance Inflation Factor):** 각 독립변수에 대해 계산. 일반적으로 VIF > 10 이면 다중공선성 의심.
    - **처리:** 변수 제거, 변수 결합(주성분 분석 등), 릿지/라쏘 회귀 등 고려.

**IV. R을 이용한 실습**

1. **중선형 회귀 모형 적합:** `lm()` 함수 사용 (`lm(y ~ x1 + x2 + ..., data = 데이터프레임)`).
2. **결과 요약:** `summary(reg1)` (단순선형회귀와 유사한 결과 출력).
    - `Coefficients`: 각 독립변수에 대한 추정 계수, 표준 오차, t 값, P-value 확인.
    - `Multiple R-squared`, `Adjusted R-squared`: 모형 설명력 확인.
    - `F-statistic`: 모형 전체 유의성 검정 결과 확인.
3. **잔차 분석:**
    - **잔차 추출:** `resid(reg1)` 또는 `reg1$residuals`.
    - **잔차 산점도:** `plot(fitted(reg1), res)` (fitted(reg1): 예측값). 수평선 `abline(0, 0)` 추가.
    - **정규 확률도:** `qqnorm(res)`, `qqline(res)`. 점들이 직선에 가까운지 확인.
4. **(추가) 영향점 및 다중공선성 진단:** `car` 패키지 등의 함수(`vif()`, `influencePlot()` 등) 활용 가능.

**핵심 요약:**

- **중선형 회귀 모형**은 **여러 개의 독립변수**를 사용하여 종속변수를 설명하는 강력한 통계적 도구입니다.
- **최소제곱법**을 통해 각 독립변수가 종속변수에 미치는 **독립적인 영향(편회귀 계수)**을 추정합니다.
- 모형의 **적합도(R², 수정 R²)**와 **유의성(F-검정)**, 그리고 각 **회귀 계수의 유의성(t-검정)**을 평가하는 것이 중요합니다.
- **회귀 진단**은 적합된 모형의 **타당성**을 검증하는 필수 과정으로, **잔차 분석**(정규성, 등분산성 등), **이상점/영향점 검토**, **다중공선성 진단**(VIF 등)을 포함합니다.
- R의 `lm()` 함수와 `summary()`, `plot()`, `qqnorm()` 등 관련 함수를 통해 중선형 회귀 분석 및 진단을 효과적으로 수행할 수 있습니다.