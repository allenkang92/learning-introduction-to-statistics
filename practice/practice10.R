#-------------------------------------------------------
# 단일 표본 t-검정 (One-sample t-test) 예제
#-------------------------------------------------------

# 데이터 설정
# n: 표본 크기 (10개)
# s: 표본표준편차 (0.2)
# bar_x: 표본평균 (12.2)
n = 10; s = 0.2; bar_x = 12.2

# 귀무가설(H₀): μ = 12 (모평균은 12이다)
# 대립가설(H₁): μ ≠ 12 (모평균은 12가 아니다) - 양측검정

# 유의수준 설정 (α = 0.05, 즉 95% 신뢰수준)
alpha = 0.05

# t-검정 통계량 계산
# 공식: t = (표본평균 - 귀무가설의 모평균) / (표본표준편차 / √표본크기)
# 이 값이 클수록 귀무가설을 기각할 가능성이 높아짐
ttest = (bar_x - 12) / (s / sqrt(n)) # 검정 통계량

# 기각역(임계값) 계산
# 양측검정이므로 α/2 = 0.025를 사용
# qt(1 - α/2, n-1): 자유도가 n-1인 t-분포에서 상위 α/2에 해당하는 값
# 이 값보다 |t|가 크면 귀무가설을 기각함
ttest_cr = qt(1 - alpha / 2, n - 1) # 기각역

# p-값(유의확률) 계산
# 양측검정이므로 단측 p-값에 2를 곱함
# p-값: 귀무가설이 참일 때, 현재 관측값 또는 더 극단적인 값을 얻을 확률
# p-값이 α보다 작으면 귀무가설을 기각함
ttest_pv = (1 - pt(abs(ttest), n - 1)) * 2 # 유의확률 (양측검정)

# 결과 출력
cat("검정통계량값 : ", ttest, "기각역 : ", ttest_cr, "유의확률 : ", ttest_pv)

# 결과 해석
# 만약 |ttest| > ttest_cr 또는 ttest_pv < alpha이면 귀무가설을 기각함
# 즉, 모평균이 12가 아니라는 결론을 내림
if(abs(ttest) > ttest_cr || ttest_pv < alpha) {
  cat("\n결론: 귀무가설을 기각합니다. 모평균은 12가 아닙니다.")
} else {
  cat("\n결론: 귀무가설을 기각할 수 없습니다. 모평균이 12라는 가설을 지지합니다.")
}