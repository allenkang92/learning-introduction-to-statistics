#-------------------------------------------------------
# 단일 표본 단측 t-검정 (One-sample one-sided t-test) 예제
#-------------------------------------------------------

# 데이터 설정
# 5명의 학생이 한 달 동안 읽은 책의 수
books = c(20, 1, 23, 15, 15)

# 단일 표본 t-검정 수행
# mu = 11: 귀무가설에서의 모평균 값 (H₀: μ = 11)
# alternative = "greater": 대립가설이 μ > 11 (모평균이 11보다 크다)인 우측 단측검정
# 
# 귀무가설(H₀): μ ≤ 11 (모평균은 11 이하이다)
# 대립가설(H₁): μ > 11 (모평균은 11보다 크다)
t.test(books, mu = 11, alternative = "greater")

#-------------------------------------------------------
# 수동으로 t-검정 계산하기
#-------------------------------------------------------

# 기본 통계량 계산
n = length(books)        # 표본 크기
bar_x = mean(books)      # 표본평균
s = sd(books)            # 표본표준편차
alpha = 0.05             # 유의수준 (5%)

# t-검정 통계량 계산
# 공식: t = (표본평균 - 귀무가설의 모평균) / (표본표준편차 / √표본크기)
t_stat = (bar_x - 11) / (s / sqrt(n))

# 기각역(임계값) 계산
# 단측검정이므로 α = 0.05를 그대로 사용
# qt(1-α, n-1): 자유도가 n-1인 t-분포에서 상위 α에 해당하는 값
# 이 값보다 t가 크면 귀무가설을 기각함
t_crit = qt(1 - alpha, n - 1)

# p-값(유의확률) 계산
# 단측검정(greater)이므로 오른쪽 꼬리 확률만 계산
# p-값: 귀무가설이 참일 때, 현재 관측값 또는 더 극단적인 값을 얻을 확률
# p-값이 α보다 작으면 귀무가설을 기각함
p_value = 1 - pt(t_stat, n - 1)

# 결과 출력
cat("표본평균:", bar_x, "\n")
cat("표본표준편차:", s, "\n")
cat("t-통계량:", t_stat, "\n")
cat("임계값(기각역):", t_crit, "\n")
cat("p-값:", p_value, "\n")

# 결과 해석
if(t_stat > t_crit || p_value < alpha) {
  cat("\n결론: 귀무가설을 기각합니다. 모평균은 11보다 크다고 할 수 있습니다.")
} else {
  cat("\n결론: 귀무가설을 기각할 수 없습니다. 모평균이 11 이하라는 가설을 지지합니다.")
}